<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<script language='JavaScript'
        src="../html/standardcpfs.js" type="text/javascript" charset="ISO-8859-15">
</script>
<script language='JavaScript'
        src="../lang/de/standardcpfsde.js" type="text/javascript" charset="ISO-8859-15">
</script>
<script language='JavaScript'
        src="../html/miicpfs.js" type="text/javascript" charset="ISO-8859-15">
</script>
<script language='JavaScript'
        src="../html/ajax.js" type="text/javascript" charset="ISO-8859-15">
</script>
<link rel="styleSheet" type="text/css" href="../html/mii.css">
<script language='JavaScript'
        src="../lang/de/miicpfsde.js" type="text/javascript" charset="ISO-8859-15">
</script>
<script language='JavaScript'
        src="../html/miiaddcpfs.js" type="text/javascript" charset="ISO-8859-15">
</script>
<script type="text/javascript">
function HTTPEncode (value)
{
var ret = value.toString();
if(ret.length==0) return "";
var ret = encodeURIComponent (ret);
return ret;
}
var xmlhttp = null;
var receiver = -1;
var resulttype = 'value';
var resultformat = 'internal';
var ajaxrunning = 0;
function CallAjax (url,vars,ireceiver,iresulttype,iresultformat)
{
ajaxrunning = 1;
var istatus = null;
if (document.formular)
istatus = eval ("document.formular.synonymstatus" + ireceiver);
if (istatus)
istatus.value = "1";
if (xmlhttp == null)
{
try
{
xmlhttp=new XMLHttpRequest();
} catch (w3c)
{
alert ("Browser does not allow to create the XMLHttpRequest object!");
ajaxrunning = 0;
if (istatus)
istatus.value = "0";
return false;
}
}
if (vars == '')
xmlhttp.open("GET",url,true);
else
{
var v = eval (vars);
xmlhttp.open("GET",url+v,true);
}
xmlhttp.onreadystatechange = HandleHttpState;
receiver = ireceiver;
resultformat = iresultformat;
resulttype = iresulttype;
xmlhttp.send("");
}
function HandleHttpState ()
{
if (xmlhttp.readyState==4)
{
var istatus = null;
if (document.formular)
istatus = eval ("document.formular.synonymstatus" + receiver);
if (xmlhttp.status == 200 || xmlhttp.status == 0)
{
if (!istatus || istatus.value == "1")
HandleResults();
}
else
alert("Error calling server via XMLHttpRequest object!");
ajaxrunning = 0;
if (istatus)
istatus.value = "0";
if (receiver != -2)
DisableButtons (false);
}
}
function HandleResults ()
{
var result = ParseData (resultformat, resulttype);
if (receiver == 29)
{  CheckAndTakeOption(result,'formular','keywords');}
else if (receiver == 42)
{  SetSynonym3(result,'formular','numberfield3',42,'eb.exe?cfgs=../cfgs/searchall.cfg&p=d&MaskName=ddoctype&attrclass_old=3&docclasses=1&folderid=10&doctypeid='+document.formular.numberfield3.value+'&doctypename=', '','take_overDoctype(\\'-1\\',\\'3\\',\\'dd#.#mm#.#yyyy\\')');;}
}
function ParseData (format, type)
{
var result = new Array ();
if (format == 'internal')
{
if (type == 'value')
result.push (xmlhttp.responseText);
else if (type == 'row')
result.concat (xmlhttp.responseText.split ('\\x11'));
else if (type == 'rows')
result.concat (xmlhttp.responseText.split ('\\x12'));
else if (type == 'rowset')
{
var arows = xmlhttp.responseText.split ('\\x12');
var i = 0;
for (i = 0; i < arows.length; i++)
result.push (arows[i].split ('\\x11'));
}
return result;
}
else
{
alert("format '" + format + "' not supported. only 'internal' supported!");
return null;
}
}
function CheckAndOutputError ()
{
if (document.formular.message.value != "")
{
var element=eval("document.formular." + document.formular.messageobject.value);
var errorvalue=document.formular.message.value;
document.formular.message.value = "";
document.formular.messageobject.value = "";
alert (errorvalue);
if (element.type == "text")
element.select();
if (!element.type && element.length > 0 && element[0].type == "radio")
element = element[0];
element.focus();
}
}
function AutoCheckOption (elementname,key2value,e)
{
if (e && ((e.which && e.which == 9) || (e.keyCode && e.keyCode == 9)))
return;
var editelement = eval ("document.formular." + elementname + "edit");
var optiontext = editelement.value.toLowerCase ();
var len = optiontext.length;
var i = 0;
var offset = 0;
var keyi = "";
var valuei = '';
var element = eval ("document.formular." + elementname);
var noptions = element.length;
var found = false;
for (i=0;i<noptions; i++)
{
valuei = element.options[i].value.toLowerCase ();
keyi = "";
if (key2value)
{
offset = valuei.lastIndexOf ("(");
if (offset != -1)
{
keyi = valuei.substr (offset+1, valuei.length-offset-2);
valuei = valuei.substr (0, offset);
}
}
if (valuei.substr(0,len)==optiontext
|| (keyi.length > 0 && keyi.substr(0,len) == optiontext))
{
element.selectedIndex = i;
found = true;
break;
}
}
if (!found)
element.selectedIndex = 0;
}
function InputChangedI (elementname)
{
var image = eval ("document." + elementname + "image");
var imageE = eval (elementname + "E");
var imageT = eval (elementname + "T");
var inputelement = eval ("document.formular." + elementname + "text");
if (inputelement.value.length == 0)
image.src=imageE.src;
else
image.src=imageT.src;
}
function HandleInputClickURLP (elementname,itemno,openparams,eburl,position,check)
{
var inputelement = eval ("document.formular." + elementname + "text");
var listelement = eval ("document.formular." + elementname + "list");
var invalue = inputelement.value;
var image = eval ("document." + elementname + "image");
var imageE = eval (elementname + "E");
var imageS = eval (elementname + "S");
if (image.src==imageE.src || image.src==imageS.src)
{
ShowSelectURLP (elementname,itemno,openparams,eburl,position);
document.formular.message.value = "";
}
else if (document.formular.message.value == "")
{
image.src=imageE.src;
inputelement.value = "";
var found=0;
if (check)
{
var j=0;
for (j=0; j<listelement.length; j++)
{
if (listelement.options[j].value == invalue)
{
found=1;
break;
}
}
}
if (found==0)
{
newEntry = new Option (invalue,invalue);
listelement.options [listelement.length]=newEntry;
}
HandleListChange (elementname)
}
else
CheckAndOutputError ();
}
function HandleInputClickURLP3 (elementname,itemno,openparams,eburl,position)
{
var listelement = eval ("document.formular." + elementname + "list");
var image = eval ("document." + elementname + "image");
var imageE = eval (elementname + "E");
var imageS = eval (elementname + "S");
if (image.src==imageE.src || image.src==imageS.src)
{
ShowSelectURLP3 (elementname,itemno,openparams,eburl,position);
document.formular.message.value = "";
}
else
CheckAndOutputError ();
}
function ShowSelectURLP (elementname,itemno,openparams,eburl,position)
{
var e1 = eval ("document.formular." + elementname + "text");
var e3 = document.getElementById(elementname+"d");
var image = eval ("document." + elementname + "image");
var imageE = eval (elementname + "E");
var imageS = eval (elementname + "S");
var eframe = eval ("window." + elementname + "i");
var aiframes = e3.getElementsByTagName('iframe');
var eframedom = null;
if (aiframes.length>0)
eframedom = aiframes[0];
if (image.src==imageE.src)
{
eframe.location.href = eburl;
eframedom.style.display = "inline";
PositionPopupFrame (e1, e3, eframedom, position);
e3.style.visibility='visible';
image.src=imageS.src;
eframe.focus();
}
else
{
eframe.location.href = "../html/blank.html";
e3.style.visibility='hidden';
image.src=imageE.src;
if (e1 && document.getElementById (elementname + 'take'))
e1.value='';
}
}
function ShowSelectURLP3 (elementname,itemno,openparams,eburl,position)
{
var e1 = eval ("document.formular." + elementname + "list");
var e3 = document.getElementById(elementname+"d");
var image = eval ("document." + elementname + "image");
var imageE = eval (elementname + "E");
var imageS = eval (elementname + "S");
var eframe = eval ("window." + elementname + "i");
var aiframes = e3.getElementsByTagName('iframe');
var eframedom = null;
if (aiframes.length>0)
eframedom = aiframes[0];
if (image.src==imageE.src)
{
eframe.location.href = eburl;
eframedom.style.display = "inline";
if (position.length == 0)
position = 'noyoffset';
else
position = position + ' noyoffset';
PositionPopupFrame (e1, e3, eframedom, position);
e3.style.visibility='visible';
image.src=imageS.src;
eframe.focus();
}
else
{
eframe.location.href = "../html/blank.html";
e3.style.visibility='hidden';
image.src=imageE.src;
}
}
function CloseIFrame (elementname)
{
var e3 = document.getElementById(elementname+"d");
var ae3 = e3.getElementsByTagName ("iframe");
if (ae3.length > 0)
{
var eframe = ae3[0];
eframe.src = "../html/blank.html";
}
var image = eval ("document." + elementname + "image");
var imageE = eval (elementname + "E");
e3.style.visibility='hidden';
image.src=imageE.src;
var eon = eval ("document.formular." + elementname + "On");
if (eon)
eon.value = "0";
}
function CalcXOffset (elementname)
{
var e1 = eval ("document.formular." + elementname);
return CalcXOffset2 (e1,true);
}
function CalcYOffset (elementname)
{
var e1 = eval ("document.formular." + elementname);
return CalcYOffset2 (e1,true);
}
function CalcXOffset2 (e,flag)
{
var e1 = e;
var e2 = e;
var x = 0;
while (e1 && e1!=document.body && e1.style.position!="absolute")
{
while (e1!=null && e2!= null && e1!=e2 && e2.style.position!="absolute")
{
x-=e2.scrollLeft;
e2=e2.parentNode;
}
x+=e1.offsetLeft;
if (e1.tagName.toLowerCase () != 'input')
x-=e1.scrollLeft;
e2=e1.parentNode;
e1=e1.offsetParent;
}
if (e1 && e1.style.position!="absolute")
x+=e1.offsetLeft;
return x;
}
function CalcYOffset2 (e,flag)
{
var e1 = e;
var e2 = e;
var y = 0;
while (e1 && e1!=document.body && e1.style.position!="absolute")
{
while (e1!=null && e2!= null && e1!=e2 && e2.style.position!="absolute")
{
y-=e2.scrollTop;
e2=e2.parentNode;
}
y+=e1.offsetTop;
y-=e1.scrollTop;
e2=e1.parentNode;
e1=e1.offsetParent;
}
if (e1 && e1.style.position!="absolute")
y+=e1.offsetTop;
return y;
}
function PositionPopupFrame (e,ediv,eframe,position)
{
var pos = position.toLowerCase ();
var apos = pos.split (' ');
var bfixed = false;
var bxfixed = false;
var byfixed = false;
var bleft = false;
var babove = false;
var bcheckx = false;
var bchecky = false;
var bdeftop = false;
var bdefleft = false;
var bdefcenter = false;
var bdefmid = false;
var bdefbelow = false;
var bdefright = false;
var bnoyoffset = false;
var bxoffset = false;
var i = 0
for (i = 0; i < apos.length; i++)
{
var p = apos[i];
if (p == 'fixed')
bfixed = true;
else if (p == 'xfixed')
bxfixed = true;
else if (p == 'yfixed')
byfixed = true;
else if (p == 'left')
bleft = true;
else if (p == 'above')
babove = true;
else if (p == 'checkx')
bcheckx = true;
else if (p == 'checky')
bchecky = true;
else if (p == 'fallbacktop')
bdeftop = true;
else if (p == 'fallbackleft')
bdefleft = true;
else if (p == 'fallbackcenter')
bdefcenter = true;
else if (p == 'fallbackmid')
bdefmid = true;
else if (p == 'fallbackbelow')
bdefbelow = true;
else if (p == 'fallbackright')
bdefright = true;
else if (p == 'noyoffset')
bnoyoffset = true;
else if (p == 'xoffset')
bxoffset = true;
}
if (!e || !ediv || !eframe)
return;
var sh = 0;
var sw = 0;
if (window.innerHeight)
{
sh = window.innerHeight;
sw = window.innerWidth;
}
else if (document.documentElement)
{
sh = document.documentElement.offsetHeight;
sw = document.documentElement.offsetWidth;
}
if (sh == 0 && document.body)
{
sh = document.body.offsetHeight;
sw = document.body.offsetWidth;
}
var y = CalcYOffset2 (e,false);
var x = CalcXOffset2 (e,false);
var frameh = Number(eframe.height);
var framew = Number(eframe.width);
var yoffset = 0;
if (bnoyoffset == false)
yoffset = e.offsetHeight;
var xoffset = 0;
if (bxoffset)
xoffset = e.offsetWidth;
if (!bxfixed && !bfixed)
{
if (bleft)
{
if (x - framew >= 0)
ediv.style.left = x - framew + 'px';
else if (!bcheckx)
ediv.style.left = '0px';
else if (x + xoffset + framew <= sw)
ediv.style.left = x + xoffset + 'px';
else if (bdefleft)
ediv.style.left = '0px';
else if (bdefcenter && (sw - framew > 0))
ediv.style.left = (sw - framew)/2 + 'px';
else if (bdefright && (sw - framew > 0))
ediv.style.left = (sw - framew) + 'px';
}
else
{
if (x + xoffset + framew <= sw || !bcheckx)
ediv.style.left = x + xoffset + 'px';
else if (bcheckx && (x - framew >= 0))
ediv.style.left = x - framew + 'px';
else if (bcheckx && bdefleft)
ediv.style.left = '0px';
else if (bcheckx && bdefcenter && sw - framew > 0)
ediv.style.left = (sw - framew)/2 + 'px';
else if (bcheckx && bdefright && sw - framew > 0)
ediv.style.left = (sw - framew) + 'px';
}
}
if (!byfixed && !bfixed)
{
if (babove)
{
if (y - frameh >= 0)
ediv.style.top = y - frameh + 'px';
else if (!bchecky)
ediv.style.top = '0px';
else if (y + yoffset + frameh <= sh)
ediv.style.top = y + yoffset + 'px';
else if (bdeftop)
ediv.style.top = '0px';
else if (bdefmid && (sh - frameh > 0))
ediv.style.top = (sh - frameh)/2 + 'px';
else if (bdefbelow && (sh - frameh > 0))
ediv.style.top = (sh - frameh) + 'px';
else if (bdeftop)
ediv.style.top = '0px';
}
else
{
if (y + yoffset + frameh <= sh || !bchecky)
ediv.style.top = y + yoffset + 'px';
else if (bchecky && (y - frameh >= 0))
ediv.style.top = y - frameh + 'px';
else if (bchecky && bdeftop)
ediv.style.top = '0px';
else if (bchecky && bdefmid && (sh - frameh > 0))
ediv.style.top = (sh - frameh)/2 + 'px';
else if (bchecky && bdefbelow && (sh - frameh > 0))
ediv.style.top = (sh - frameh) + 'px';
}
}
}
function HandleInputClick2 (elementname,check)
{
var inputelement = eval ("document.formular." + elementname + "text");
var listelement = eval ("document.formular." + elementname + "list");
var invalue = inputelement.value;
if (invalue.length > 0 && document.formular.message.value == "")
{
inputelement.value = "";
var found=0;
if (check)
{
var j=0;
for (j=0; j<listelement.length; j++)
{
if (listelement.options[j].value == invalue)
{
found=1;
break;
}
}
}
if (found==0)
{
newEntry = new Option (invalue,invalue);
listelement.options [listelement.length]=newEntry;
}
HandleListChange (elementname)
}
else if (document.formular.message.value != "")
CheckAndOutputError ();
}
function HandleAutoTakeP (elementname, errmess)
{
var inputelement = eval ("document.formular." + elementname + "text");
var listelement = eval ("document.formular." + elementname + "list");
var invalue = inputelement.value;
var image = eval ("document." + elementname + "image");
var imageE = eval (elementname + "E");
if (invalue.length > 0 && errmess == "")
{
image.src=imageE.src;
inputelement.value = "";
newEntry = new Option (invalue,invalue);
listelement.options [listelement.length]=newEntry;
HandleListChange (elementname)
}
}
function HandleDeleteClick (elementname)
{
var listelement = eval ("document.formular." + elementname + "list");
for (i=listelement.length - 1; i >= 0; i--)
{
if (listelement.options[i].selected != 0)
listelement.options[i] = null;
}
HandleListChange (elementname);
document.formular.message.value = "";
}
function HandleListChange (elementname)
{
var listelement = eval ("document.formular." + elementname + "list");
var hiddenelement = eval ("document.formular." + elementname);
var result = "";
for (i=0; i<listelement.length; i++)
{
if (result != "")
result += '|';
result += listelement.options[i].value;
}
hiddenelement.value = result;
var listsize = eval ("document.formular." + elementname + "size");
if (listsize != null)
CheckMinimize (elementname);
}
function AddSelections (elementname,selectionvalue, selectiontext)
{
var bFound=0;
var listelement = eval ("document.formular." + elementname + "list");
var nValues = listelement.length;
for (i=0;i<nValues; i++)
{
if (listelement.options[i].value==selectionvalue)
{
bFound=1;
break;
}
}
if (!bFound)
listelement.options[listelement.length]=new Option(selectiontext,selectionvalue);
HandleListChange (elementname);
}
var selecteditfield = false;
function CheckAndTakeOption (result, form, field)
{
var rows = result.length;
if (rows == 0 || (rows==1 && result[0].length==1) || rows > 2)
{
var es = document.getElementById (field + 'slink');
submitblocked='';
if (es)
{
var link = es.href;
link = link.substr (11);
eval (link);
}
else
{
es = eval ('document.' + form + '.' + field + 'button');
if (es)
es.click ();
}
}
else
{
var r = result[0];
var v = r[0] + '(' + r[1] + ')';
var t = r[0];
AddSelections (field, v, t);
var e = eval ('document.' + form + '.' + field + 'text');
var l = eval ('document.' + form + '.' + field + 'list');
l.focus ();
l.selectedIndex = l.length - 1;
if (e)
{
e.value = '';
if (selecteditfield)
e.focus();
}
selecteditfield = false;
}
}
function Check4EnterIfAjax (e)
{
var e = e || window.event;
if (e.keyCode==13)
{
if (window.event)
ajaxrunning=1;
else
e.target.blur();
}
return true;
}
function CheckAndOpenSynonymIFrame (field,fieldindex,url,min,message,addjs)
{
var eon = eval ("document.formular." + field + "On");
var istatus = eval ("document.formular.synonymstatus" + fieldindex);
if (eon.value=="1" || istatus.value=="1")
return true;
if (CheckSynonymIFrame(field,fieldindex,min,message,addjs,false))
{
var shorttext = eval ("document.formular." + field + "short");
var iframe = eval (field + "i");
iframe.location.href = url + HTTPEncode(shorttext.value);
return true;
}
else
return false;
}
function CheckSynonymIFrame (field,fieldindex,min,message,addjs,notempty)
{
var istatus = eval ("document.formular.synonymstatus" + fieldindex);
istatus.value="0";
var shorttext = eval ("document.formular." + field + "short");
var eid = eval ("document.formular." + field);
if (shorttext.value.length == 0)
{
var el = eval ("document.formular." + field + "long");
eid.value = "";
el.value = "";
if (addjs && addjs.length > 0)
eval (addjs);
if (notempty)
return false;
}
if (min > 0)
{
if (shorttext && shorttext.value.length < min)
{
if (message.length>0)
alert (message);
istatus.value="-1";
return false;
}
}
return true;
}
function PopUpSynonym (elementname,elementindex,position,addjs)
{
var e1 = eval ("document.formular." + elementname + "short");
var e3 = document.getElementById(elementname+"d");
var eon = eval ("document.formular." + elementname + "On");
var image = eval ("document." + elementname + "image");
var imageE = eval (elementname + "E");
var imageS = eval (elementname + "S");
var ae3 = e3.getElementsByTagName ("iframe");
var eframe = null;
if (ae3.length > 0)
eframe = ae3[0];
if (eon.value=="1")
{
var istatus = eval ("document.formular.synonymstatus" + elementindex);
if (istatus.value!="0")
return;
if (eframe)
{
eframe.src = "../html/blank.html";
eframe.style.display = "none";
}
e3.style.visibility='hidden';
if (imageE)
image.src=imageE.src;
e1.value="";
var eid = eval ("document.formular." + elementname);
eid.value="";
var el = eval ("document.formular." + elementname + "long");
el.value="";
if (addjs && addjs.length > 0)
eval (addjs);
e1.focus();
eon.value="0";
}
else
{
var istatus = eval ("document.formular.synonymstatus" + elementindex);
if (istatus.value!="0")
return;
PositionPopupFrame (e1, e3, eframe, position);
e3.style.visibility='visible';
if (eframe)
eframe.style.display = "inline";
if (imageS)
image.src=imageS.src;
eon.value='1';
e3.focus();
}
}
function SetSynonymFields (field, id, shorttext, longtext)
{
var eid = eval ("document.formular." + field);
var es = eval ("document.formular." + field + "short");
var el = eval ("document.formular." + field + "long");
eid.value = id;
es.value = shorttext;
el.value = longtext;
}
function SetSynonym (result,form,field,fieldindex,url)
{
SetSynonym3 (result,form,field,fieldindex,url,'','');
}
function SetSynonym2 (result,form,field,fieldindex,url,position)
{
SetSynonym3 (result,form,field,fieldindex,url,position,'');
}
function SetSynonym3 (result,form,field,fieldindex,url,position,addjs)
{
var r = 0;
var c = 0;
var rows = result.length;
if ((rows == 1 && result[0].length > 1) || (rows==2 && result[1].length==1))
{
var arow = result[0];
var cols = arow.length;
if (cols != 3)
return;
var eh = eval ("document.formular." + field);
var es = eval ("document.formular." + field + "short");
var el = eval ("document.formular." + field + "long");
eh.value = arow[0];
es.value = arow[1];
el.value = arow[2];
if (addjs.length > 0)
eval (addjs);
}
else
{
submitblocked = ''; // no delayed submit
var istatus = eval ("document.formular.synonymstatus" + fieldindex);
if (istatus)
istatus.value = 0; // else opening iframe would be blocked
CheckAndOpenSynonymIFrame(field,fieldindex,url,0,'',addjs);
PopUpSynonym (field,fieldindex,position,addjs);
}
}
function AbortSynonymIFrame (field,addjs)
{
CloseIFrame (field);
var es = eval ("document.formular." + field + "short");
var el = eval ("document.formular." + field + "long");
var eid = eval ("document.formular." + field);
if (eid.value.length == 0)
{
el.value = "";
es.value = "";
}
if (addjs && addjs.length > 0)
eval (addjs);
}
function DisableButtons (disable)
{
if (buttons2disable)
{
var i = 0;
for (i = 0; i < buttons2disable.length; i++)
{
var but = document.getElementsByName (buttons2disable[i]);
if (but && but.length > 0)
but = but[0];
else
but = null;
if (but)
{
but.disabled = disable;
var image = disableimages[i];
if (image.length > 0)
{
disableimages[i] = but.src;
but.src = image;
}
var style = disablestyles[i];
if (style.length > 0)
{
disablestyles[i] = but.className;
but.className = style;
}
}
}
}
}
function DisableOtherButtons (submitbutton, disable)
{
if (otherbuttons2disable)
{
var i = 0;
for (i = 0; i < otherbuttons2disable.length; i++)
{
var but = document.getElementsByName (otherbuttons2disable[i]);
if (but && but.length > 0)
but = but[0];
else
but = null;
if (but && but != submitbutton)
{
but.disabled = disable;
var image = otherdisableimages[i];
if (image.length > 0)
{
otherdisableimages[i] = but.src;
but.src = image;
}
var style = otherdisablestyles[i];
if (style.length > 0)
{
otherdisablestyles[i] = but.className;
but.className = style;
}
}
}
}
}
function HasAjaxFinished ()
{
if (ajaxrunning == 1)
{
setTimeout ("HasAjaxFinished ()", 1000);
return true;
}
if (submitblocked.length > 0)
{
var but = eval ("document.formular." + submitblocked);
if (but)
{
if (CallAllCpfs () == true)
{
but.disabled = false;
but.click ();
}
}
}
return true;
}
</script>
</head>
<body
        OnLoad="if (document.formular.title) document.formular.title.focus();if(parent.ShowFrame) parent.ShowFrame(2,1)">
<script language='JavaScript'>
    var cancelbutton=0;
    var buttonwarning='';
    var submitbutton=null;
    var enableimage='';
    var enablestyle='';
    var submitblocked = '';
    function CallAllCpfs ()
    {
    if (submitbutton)
    {
    submitbutton.disabled=true;
    DisableOtherButtons (submitbutton,true);
    }
    if (ajaxrunning==1 && cancelbutton==0)
    {
    DisableButtons (true);
    setTimeout ("HasAjaxFinished()", 1000);
    if (submitblocked.length == 0)
    submitblocked = 'button0';
    return false;
    }
    submitblocked = '';
    var allmess='';
    var errmess='';
    var okay=true;
    document.formular.message.value="";
    errmess = check_notnull (document.formular.docclass,'Dokumentklasse&nbsp;&nbsp;&nbsp;');
    if (errmess != "")
    {
    allmess += errmess + "\\r\\n";
    }
    errmess = check_notnull (document.formular.title,'Titel');
    if (errmess != "")
    {
    allmess += errmess + "\\r\\n";
    }
    errmess = cpfmaxlen (document.formular.pcomment,'maxlen=1000 execute=exitmask name=Kommentar');
    if (errmess != "")
    {
    allmess += errmess + "\\r\\n";
    }
    errmess = cpftreecode (document.formular.treecodelist,'execute=exitmask');
    if (errmess != "")
    {
    allmess += errmess + "\\r\\n";
    }
    errmess = check_notnull (document.formular.pstatus,'Status');
    if (errmess != "")
    {
    allmess += errmess + "\\r\\n";
    }
    errmess = to_date (document.formular.validdate,'dd#.#mm#.#yyyy');
    if (errmess != "")
    {
    allmess += errmess + "\\r\\n";
    }
    errmess = check_notnull (document.formular.attrclass,'Attributklasse');
    if (errmess != "")
    {
    allmess += errmess + "\\r\\n";
    }
    errmess = check_notnull (document.formular.numberfield3,'Dokumenttyp');
    if (errmess != "")
    {
    allmess += errmess + "\\r\\n";
    }
    errmess = CheckFolderidvalid (document.formular.folderidvalid,'Sie haben den Zielordner geÃ¤ndert, drÃ¼cken sie danach bitte Pfad prÃ¼fen');
    if (errmess != "")
    {
    allmess += errmess + "\\r\\n";
    }
    if (allmess != '' && cancelbutton == 0)
    {
    alert(allmess);
    document.formular.message.value="";
    buttonwarning='';
    if (submitbutton)
    {
    DisableOtherButtons (submitbutton,false);
    submitbutton.disabled=false;
    if (enableimage.length>0)
    submitbutton.src=enableimage;
    if (enablestyle.length>0)
    submitbutton.className=enablestyle;
    submitbutton=null;
    enableimage='';
    enablestyle='';
    }
    return false;
    }
    cancelbutton = 0;
    if (buttonwarning=='')
    {
    if (submitbutton)
    {
    document.formular.action += "&" + submitbutton.name + "=1";
    }
    return true;
    }
    else
    {
    fret = confirm(buttonwarning);
    buttonwarning='';
    if (fret && submitbutton)
    document.formular.action += "&" + submitbutton.name + "=1";
    if (!fret && submitbutton)
    {
    DisableOtherButtons (submitbutton,false);
    submitbutton.disabled=false;
    if (enableimage.length>0)
    submitbutton.src=enableimage;
    if (enablestyle.length>0)
    submitbutton.className=enablestyle;
    submitbutton=null;
    enableimage='';
    enablestyle='';
    }
    return fret;
    }
    }
</script>
<form name="formular" prname="user" method=Post action="eb.exe?cfgs=..%2Fcfgs%2Fdocops.cfg&p=form&adddata=" autocomplete="off" onSubmit="return CallAllCpfs ();">
<input type="hidden" name="MaskName" value="freattr">
<input type="hidden" name="fileid" value="fca2f6d04-7821-11e1-86e6-f0c99bbca093">
<input type="hidden" name="eblanguage" id="eblanguage" value="1">
<table class="FormMainTable">
<tr><td class="FormHeaderTD">
      <span class="FormHeader">
<img src="../images/d_reattr.gif" border="0" align="absmiddle" style="background-color:white">
      &nbsp;Dokument reattributieren
</span></td></tr>
<tr><td>
    <table class="FormFieldTable" style="width:700px">
        <input type="hidden" name="filenameorg" value="">
        <tr ><td class="FormLabelTD">
            <span class="MandatoryField">*</span><span class="FormLabel">Dokumenttyp</span>
        </td>
            <td class="FormFieldTD">
                <input type="hidden" name="numberfield3"  value="6">
                <table cellpadding="0" cellspacing="0" border="0"><tr><td>
                    <input type="text" size=20 maxlength=100 name="numberfield3short"  value="Brief"

                           class="FormFieldStyle"
                           onFocus="CheckAndOutputError()" onChange="document.formular.numberfield3.value='';if (!CheckSynonymIFrame('numberfield3',42,0,'','',true))  return;;CallAjax ('eb.exe?cfgs=../cfgs/searchall.cfg&p=list&MaskName=ldoctypes1&attrclass_old=3&docclasses=1&folderid=10&doctypename=','encodeMe(document.formular.numberfield3short.value)',42,'rowset','internal');">
                </td><td><a href="javascript:PopUpSynonym('numberfield3',42,'');"
                            onClick="document.formular.synonymstatus42.value=0; CheckAndOpenSynonymIFrame('numberfield3',42,'eb.exe?cfgs=../cfgs/searchall.cfg&p=d&MaskName=ddoctype&attrclass_old=3&docclasses=1&folderid=10&doctypename=',0,'','');">
                    <img src="../images/expand.gif" name="numberfield3image" class="ButtonsStyle"></a>
                </td><td><input type="text" size="49" maxlength="150" name="numberfield3long"  value="Schriftverkehr - Brief"
                                class="FormFieldStyle" disabled>
                </td></tr></table>
                <div id="numberfield3d" style="position:absolute;top:0;left:0;visibility:hidden;z-index:100">
                    <iframe name="numberfield3i" width="520" height="470" align="left" frameborder="1" style="display:none"> nix iframe</iframe>
                </div>
                <input type="hidden" name="numberfield3On" value=0>
                <input type="hidden" name="synonymstatus42" value=0>
                <script language='JavaScript'>
                    numberfield3E=new Image();
                    numberfield3S=new Image();
                    numberfield3E.src="../images/expand.gif";
                    numberfield3S.src="../images/expand.gif";
                </script>
            </td>
        </tr>
        <tr ><td class="FormLabelTD">
            <span class="MandatoryField">*</span><span class="FormLabel">Attributklasse</span>
        </td>
            <td class="FormFieldTD">
                <span class="FormFieldStyle"> Standardattribute mit Status </span>
                <input type="hidden" name="attrclass" value="Standardattribute mit Status(3)">
            </td>
        </tr>
        <tr ><td class="FormLabelTD">
            <span class="MandatoryField">*</span><span class="FormLabel">Dokumentklasse&nbsp;&nbsp;&nbsp;</span>
        </td>
            <td class="FormFieldTD">
                <select name='docclass'
                        class="FormFieldStyle" style="width:468px;"
                        onFocus="CheckAndOutputError()"
                        onChange="" size=1>
                    <option  selected  value="Versionsdokument(1)">Versionsdokument </option>
                </select>
            </td>
        </tr>
        <tr ><td class="FormLabelTD">
            <span class="MandatoryField">*</span><span class="FormLabel">Referenz auf</span>
        </td>
            <td class="FormFieldTD">
                <table border="0" cellpadding="0" cellspacing="0">
                    <tr>
                        <td>
                            <input type=radio name='storemode1' checked value='Zu scannendes Dokument(3)'
                                   onFocus="CheckAndOutputError()"
                                   Disabled style="vertical-align:middle">
                            <span class="FormFieldStyle" style="vertical-align:middle" nowrap>Zu scannendes Dokument</span>
                        </td>
                        <td>
                            <input type=radio name='storemode1' value='Sonstiger Ablageort(0)'
                                   onFocus="CheckAndOutputError()"
                                   Disabled style="vertical-align:middle">
                            <span class="FormFieldStyle" style="vertical-align:middle" nowrap>Sonstiger Ablageort</span>
                        </td></tr>
                    <tr>
                        <td>
                            <input type=radio name='storemode1' value='Web-Seite (URL)(2)'
                                   onFocus="CheckAndOutputError()"
                                   Disabled style="vertical-align:middle">
                            <span class="FormFieldStyle" style="vertical-align:middle" nowrap>Web-Seite (URL)</span>
                        </td>
                        <td>
                            <input type=radio name='storemode1' value='Datei (UNC-Pfad)(1)'
                                   onFocus="CheckAndOutputError()"
                                   Disabled style="vertical-align:middle">
                            <span class="FormFieldStyle" style="vertical-align:middle" nowrap>Datei (UNC-Pfad)</span>
                        </td></tr>
                </table>
            </td>
        </tr>
        <input type="hidden" name="hint" value="">
        <tr ><td width=130px>
            <span class="MandatoryField">*</span><span class="FormLabel">Titel</span>
        </td>
            <td class="FormFieldTD">
                <input type="text" size=75 maxlength=150 name="title"
                       value="Blabla"
                       class="FormFieldStyle"
                       onFocus="CheckAndOutputError()">
            </td>
        </tr>
        <tr ><td class="FormLabelTD">
            <span class="FormLabel">Dateiname</span>
        </td>
            <td class="FormFieldTD">
                <input type="hidden" name="filename" value="">
                <span class="FormFieldStyle">  </span>
            </td>
        </tr>
    </table></td></tr>
<tr><td><table class="FormFieldTable" style="width:700px">
    <tr ><td width=130px>
        <span class="FormLabel">Eingestellt</span>
    </td>
        <td width=120px>
            <input type="hidden" name="createdat" value="27.03.2012 17:30">
            <span class="FormFieldStyle"> 27.03.2012 17:30 </span>
        </td>
        <td width=40px>
            <span class="FormLabel">von</span>
        </td>
        <td class="FormFieldTD">
            <span class="FormFieldStyle"> Grombach, Karsten </span>
            <input type="hidden" name="createdby" value="Grombach, Karsten(grombach)">
        </td>
    </tr>
    <tr ><td class="FormLabelTD">
        <span class="FormLabel">GeÃ¤ndert am</span>
    </td>
        <td class="FormFieldTD">
            <input type="hidden" name="lastmodifiedat" value="27.03.2012 17:30">
            <span class="FormFieldStyle"> 27.03.2012 17:30 </span>
        </td>
        <td class="FormLabelTD">
            <span class="FormLabel">von</span>
        </td>
        <td class="FormFieldTD">
            <span class="FormFieldStyle"> Grombach, Karsten </span>
            <input type="hidden" name="lastmodifiedby" value="Grombach, Karsten(grombach)">
        </td>
    </tr>
</table></td></tr>
<tr><td><table class="FormFieldTable" style="width:700px">
    <tr ><td width=130px>
        <span class="FormLabel">Ausgecheckt von&nbsp;&nbsp;</span>
    </td>
        <td class="FormFieldTD">
            <span class="FormFieldStyle">  </span>
            <input type="hidden" name="checkedoutby" value="">
        </td>
    </tr>
    <tr ><td width=130px>
        <span class="FormLabel">VerknÃ¼pfungen</span>
    </td>
        <td class="FormFieldTD">
            <input type="hidden" name="links" value="">
            <span class="FormFieldStyle">  </span>
        </td>
    </tr>
    <input type="hidden" name="circulars" value="">
    <input type="hidden" name="hint21" value="">
    <tr ><td class="FormLabelTD">
        <span class="FormLabel">Autor</span>
    </td>
        <td class="FormFieldTD">
            <nobr><input type=text size='20' maxlength=50 name='authoredit'
                         onKeyup="AutoCheckOption(document.formular.author.name, false,event)"

                         class="FormFieldStyle"
                         onFocus="CheckAndOutputError()">
                <select name='author'
                        class="FormFieldStyle" style="width:325px;"
                        onFocus="CheckAndOutputError()" size=1>
                    <option  value="Ehring, Thomas">Ehring, Thomas </option>
                    <option  selected  value="Grombach, Karsten">Grombach, Karsten </option>
                    <option  value="Install, User">Install, User </option>
                    <option  value="Klinker, Monika">Klinker, Monika </option>
                    <option  value="Macht, Werner">Macht, Werner </option>
                    <option  value="mii, Gast">mii, Gast </option>
                    <option  value="System, Administrator">System, Administrator </option>
                </select>
            </nobr>
        </td>
    </tr>
    <tr ><td width="130px">
        <span class="FormLabel">Kommentar</span>
    </td>
        <td class="FormFieldTD">
            <textarea name="pcomment" rows=2 cols=74 wrap=virtual
                      class="StyleTextArea"
                      onBlur="document.formular.message.value=cpfmaxlen(this,'maxlen=1000 execute=exitfield name=Kommentar');document.formular.messageobject.value=this.name"
                      onFocus="CheckAndOutputError()"></textarea>
        </td>
    </tr>
</table></td></tr>
<tr><td><table class="FormFieldTable" style="width:700px">
    <tr >  <td width="130px"><span class="FormLabel">Branchen</span>
    </td>
        <td class="FormFieldTD"><input type="hidden" name="treecode" value="">
            <table border="0" cellspacing="0" cellpadding="0">
                <tr><td>
                    <select name="treecodelist" size=3 multiple
                            class="FormFieldStyle" style="width:468px;"
                            onChange="HandleListChange(document.formular.treecode.name)"
                            onBlur="document.formular.message.value=cpftreecode(this,'execute=exitfield');document.formular.messageobject.value=this.name"
                            onFocus="CheckAndOutputError()">
                    </select>
                </td>
                    <td height="100%">
                        <table border="0" cellspacing="0" cellpadding="0" height="100%">
                            <tr height="100%"><td height="100%" style="vertical-align:top">

                                <a  class="FormFieldStyle"
                                    href="javascript:HandleInputClickURLP3(document.formular.treecode.name,26,'width=220,height=280,resizeable=yes','eb.exe?cfgs=../cfgs/searchall.cfg&p=form&MaskName=fsearchtreecodes','')">
                                    <img src="../images/expand.gif" name="treecodeimage" border="0"></a>
                                <div id="treecoded" style="position:absolute;top:0;left:0;visibility:hidden;z-index:100">
                                    <iframe name="treecodei" width="500" height="400" align="left" frameborder="1"
                                            style="display:none">
                                        nix iframe
                                    </iframe>
                                </div>
                                <script language='JavaScript'>
                                    treecodeE=new Image();
                                    treecodeS=new Image();
                                    treecodeT=new Image();
                                    treecodeE.src="../images/expand.gif";
                                    treecodeS.src="../images/shrink.gif";
                                    treecodeT.src="../images/take.gif";
                                </script>
                            </td></tr>
                            <tr height="100%">
                                <td height="100%" style="vertical-align:bottom">
                                    <a href="javascript:HandleDeleteClick(document.formular.treecode.name)">
                                        <img src="../images/edeleted.gif" border="0"></a>
                                </td></tr></table>
                    </td></tr></table>
        </td>
    </tr>
    <tr ><td width="130px">
        <span class="FormLabel">GeschÃ¤ftsbereich</span>
    </td>
        <td class="FormFieldTD">
            <select name='businessarea'
                    class="FormFieldStyle" style="width:468px;"
                    onFocus="CheckAndOutputError()" size=1>
                <option  value=""> </option>
                <option  value="Zentrale Dienste(1)">Zentrale Dienste </option>
                <option  value="Leitung(2)">Leitung </option>
                <option  value="Marketing(3)">Marketing </option>
                <option  value="Vertrieb(4)">Vertrieb </option>
                <option  value="Entwicklung(5)">Entwicklung </option>
            </select>
        </td>
    </tr>
    <tr ><td class="FormLabelTD">
        <span class="FormLabel">Infotyp</span>
    </td>
        <td class="FormFieldTD">
            <select name='infotype'
                    class="FormFieldStyle" style="width:468px;"
                    onFocus="CheckAndOutputError()" size=1>
                <option  value=""> </option>
                <option  value="Artikel(18)">Artikel </option>
                <option  value="Basics(25)">Basics </option>
                <option  value="Bericht(3)">Bericht </option>
                <option  value="Betriebsvereinbarung(19)">Betriebsvereinbarung </option>
                <option  value="Branchenstudie(10)">Branchenstudie </option>
                <option  value="CD-ROM(14)">CD-ROM </option>
                <option  value="Dienstanweisung(6)">Dienstanweisung </option>
                <option  value="Fachbuch(12)">Fachbuch </option>
                <option  value="FÃ¶rderprogramm(9)">FÃ¶rderprogramm </option>
                <option  value="Formular(5)">Formular </option>
                <option  value="GeschÃ¤ftsbericht(11)">GeschÃ¤ftsbericht </option>
                <option  value="GeschÃ¤ftsbrief(16)">GeschÃ¤ftsbrief </option>
                <option  value="Interna(26)">Interna </option>
                <option  value="Newsletter(21)">Newsletter </option>
                <option  value="Pressemitteillung(20)">Pressemitteillung </option>
                <option  value="Recherche(4)">Recherche </option>
                <option  value="Seminarunterlagen(8)">Seminarunterlagen </option>
                <option  selected  value="Standard(15)">Standard </option>
                <option  value="Statistik(23)">Statistik </option>
                <option  value="Streng Vertraulich(27)">Streng Vertraulich </option>
                <option  value="Termine(24)">Termine </option>
                <option  value="Vermerk(17)">Vermerk </option>
                <option  value="Vertrag(2)">Vertrag </option>
                <option  value="Vorlage(1)">Vorlage </option>
                <option  value="Zeitschrift/Zeitung(13)">Zeitschrift/Zeitung </option>
            </select>
        </td>
    </tr>
    <tr >  <td class="FormLabelTD"><span class="FormLabel">Schlagworte</span>
    </td>
        <td class="FormFieldTD">
            <nobr>
                <input type="text" name="keywordstext" size=75 maxlength=40
                       class="FormFieldStyle"

                       onBlur="if (this.value.length > 0 ) CallAjax ('eb.exe?cfgs=../cfgs/folderops.cfg&p=list&MaskName=lcheckkeywords&keyword_de=','encodeMe(document.formular.keywordstext.value)',29,'rowset','internal');"
                       onFocus="CheckAndOutputError()"
                       onKeypress="if (this.value.length > 0) return Check4EnterIfAjax (event);" >
                <a id="keywordsslink"  class="ButtonsStyle"
                   href="javascript:HandleInputClickURLP(document.formular.keywords.name,29,'width=220,height=280,resizeable=yes','eb.exe?cfgs=../cfgs/folderops.cfg&p=d&MaskName=dgetkeywords&keyword_de='+encodeMe(document.formular.keywordstext.value),'',false)"
                   onClick="if (ajaxrunning == 1 && receiver == 29) receiver = -1;">
                    <img src="../images/expand.gif" name="keywordsimage" border="0"></a>
                <div id="keywordsd" style="position:absolute;top:0;left:0;visibility:hidden;z-index:100">
                    <iframe name="keywordsi" width="520" height="400" align="left" frameborder="1"
                            style="display:none" src="../html/blank.html">
                        nix iframe
                    </iframe>
                </div>

                <a id="keywordstake"   class="ButtonsStyle"
                   onClick="selecteditfield=true;">
                    <img src="../images/take.gif" border="0"></a>
                <script language='JavaScript'>
                    keywordsE=new Image();
                    keywordsS=new Image();
                    keywordsT=new Image();
                    keywordsE.src="../images/expand.gif";
                    keywordsS.src="../images/shrink.gif";
                    keywordsT.src="../images/take.gif";
                </script>
            </nobr>
            <br>
            <input type="hidden" name="keywords" value="">
            <table border="0" cellspacing="0" cellpadding="0">
                <tr><td>
                    <select name="keywordslist" size=5 multiple
                            class="FormFieldStyle" style="width:468px;"
                            onChange="HandleListChange(document.formular.keywords.name)"
                            onFocus="CheckAndOutputError()">
                    </select>
                </td>
                    <td height="100%" style="vertical-align:bottom">
                        <a href="javascript:HandleDeleteClick(document.formular.keywords.name)">
                            <img src="../images/edeleted.gif" border="0"></a>
                    </td></tr></table>
        </td>
    </tr>
    <tr ><td class="FormLabelTD">
        <span class="MandatoryField">*</span><span class="FormLabel">Status</span>
    </td>
        <td class="FormFieldTD">
            <select name='pstatus'
                    class="FormFieldStyle" style="width:468px;"
                    onFocus="CheckAndOutputError()" size=1>
                <option  value=""> </option>
                <option  value="im Aufbau(1)">im Aufbau </option>
                <option  value="im Test(2)">im Test </option>
                <option  value="im Probeeinsatz(3)">im Probeeinsatz </option>
                <option  value="zum Einsatz freigegeben(4)">zum Einsatz freigegeben </option>
                <option  value="auÃŸer Gebrauch(5)">auÃŸer Gebrauch </option>
            </select>
        </td>
    </tr>
    <tr ><td class="FormLabelTD">
        <span class="FormLabel">GÃ¼ltig bis</span>
    </td>
        <td class="FormFieldTD">
            <nobr><input type="text" size=10 maxlength=10 name="validdate"
                         value="06.04.2012"
                         class="FormFieldStyle"
                         onBlur="document.formular.message.value=to_date(this,'dd#.#mm#.#yyyy');document.formular.messageobject.value=this.name"
                         onFocus="CheckAndOutputError()"
                         readonly>
                <select name='validscope'
                        class="FormFieldStyle" style="width:115px;"
                        onFocus="CheckAndOutputError()"
                        onChange="cpfSetValidDate(this,'validdate')" size=1>
                    <option  value="10 Tage(10)">10 Tage </option>
                    <option  value="1 Monat(30)">1 Monat </option>
                    <option  value="1,5 Jahre(547)">1,5 Jahre </option>
                    <option  value="6 Jahre(2190)">6 Jahre </option>
                    <option  selected  value="unbegrenzt(0)">unbegrenzt </option>
                </select>
            </nobr></td>
    </tr>
    <tr ><td class="FormLabelTD">
        <span class="FormLabel">danach</span>
    </td>
        <td class="FormFieldTD">
            <select name='validmode'
                    class="FormFieldStyle" style="width:200px;"
                    onFocus="CheckAndOutputError()" size=1>
                <option  value="LÃ¶schen(0)">LÃ¶schen </option>
                <option  value="auf Wiedervorlage(1)">auf Wiedervorlage </option>
                <option  selected  value=""> </option>
            </select>
        </td>
    </tr>
    <input type="hidden" name="nextmask" value="">
    <input type="hidden" name="changeurl" value="eb.exe?cfgs=../cfgs/docops.cfg&p=form&MaskName=freattr&fileid=fca2f6d04-7821-11e1-86e6-f0c99bbca093&changed=1">
</table>
</td></tr>
</table>
<input type=submit name=button0 value="Dokument reattributieren" onClick="submitbutton=this;submitblocked=this.name" class="ButtonsStyle">
<input type=hidden name=button0command value='change;((EBWildcardTrigger18;|[[EBLocalVariable7]]EB))EBeb.exe?cfgs=../cfgs/docops.cfg&p=statusline&MaskName=slreattrok&fileid=((EBPQValuefileid=text))EB'>
<input type=button name=button1 value="Abbrechen" onClick="window.parent.ShowFrame(1,2)" class="ButtonsStyle">
<script language="JavaScript">
    var buttons2disable = new Array ('button0','button1');
    var disableimages = new Array ('','');
    var disablestyles = new Array ('','');
</script>
<script language="JavaScript">
    var otherbuttons2disable = new Array ('button0','button1');
    var otherdisableimages = new Array ('','');
    var otherdisablestyles = new Array ('','');
</script>
<input type=hidden name=message value="">
<input type=hidden name=messageobject value="">
</form>
</body></html>
